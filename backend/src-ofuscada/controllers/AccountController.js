(function(_0x14a6be,_0x215b0d){const _0x261d91=a0_0x1fb7,_0x5d8fee=_0x14a6be();while(!![]){try{const _0x12a09f=-parseInt(_0x261d91(0xb2))/0x1*(parseInt(_0x261d91(0xdb))/0x2)+parseInt(_0x261d91(0xd8))/0x3+-parseInt(_0x261d91(0xc4))/0x4+-parseInt(_0x261d91(0xd9))/0x5+parseInt(_0x261d91(0xb4))/0x6*(-parseInt(_0x261d91(0xcc))/0x7)+-parseInt(_0x261d91(0xb7))/0x8+parseInt(_0x261d91(0xca))/0x9;if(_0x12a09f===_0x215b0d)break;else _0x5d8fee['push'](_0x5d8fee['shift']());}catch(_0x300cdb){_0x5d8fee['push'](_0x5d8fee['shift']());}}}(a0_0xb7f1,0x790ec));import{Account}from'../models/Account.js';import{Roles}from'../models/Roles.js';import{Users}from'../models/Users.js';import a0_0x39c844 from'bcrypt';export const getAccounts=async(_0x4a1b69,_0x11e0bb)=>{const _0x3bf08d=a0_0x1fb7;try{const _0x107924=await Account[_0x3bf08d(0xcf)]({'include':[{'model':Roles,'as':_0x3bf08d(0xd3)},{'model':Users,'as':'user'}]});_0x11e0bb[_0x3bf08d(0xc8)](_0x107924);}catch(_0x4766e9){console['error'](_0x3bf08d(0xb3),_0x4766e9),_0x11e0bb[_0x3bf08d(0xc2)](0x1f4)[_0x3bf08d(0xc8)]({'message':_0x3bf08d(0xce)});}};function a0_0x1fb7(_0x23c749,_0x851ab9){const _0xb7f146=a0_0xb7f1();return a0_0x1fb7=function(_0x1fb734,_0x18c9d2){_0x1fb734=_0x1fb734-0xb2;let _0x4dce05=_0xb7f146[_0x1fb734];return _0x4dce05;},a0_0x1fb7(_0x23c749,_0x851ab9);}export const getOneAccount=async(_0x3751ce,_0x2db584)=>{const _0x2f2e4c=a0_0x1fb7,{id:_0x4e37b4}=_0x3751ce[_0x2f2e4c(0xbd)];try{const _0x50d593=await Account['findOne']({'attributes':[_0x2f2e4c(0xd1),_0x2f2e4c(0xbc),_0x2f2e4c(0xd5)],'where':{'id':_0x4e37b4}});_0x2db584['json'](_0x50d593);}catch(_0x44564a){_0x2db584['status'](0x1f4)['json']({'message':_0x44564a[_0x2f2e4c(0xb9)]});}};export const getAccount=async(_0x1fdc4d,_0x46f67b)=>{const _0x1d3911=a0_0x1fb7,{userId:_0x2f88d5,rolId:_0x19fb23}=_0x1fdc4d[_0x1d3911(0xbd)];try{const _0x2c6516=await Account[_0x1d3911(0xd4)]({'where':{'userId':_0x2f88d5,'rolId':_0x19fb23},'include':[{'model':Roles,'as':_0x1d3911(0xd3)},{'model':Users,'as':_0x1d3911(0xd7)}]});_0x46f67b[_0x1d3911(0xc8)](_0x2c6516);}catch(_0x209ce7){_0x46f67b['status'](0x1f4)[_0x1d3911(0xc8)]({'message':_0x209ce7[_0x1d3911(0xb9)]});}};export const addAccount=async(_0x271d91,_0x186e6a)=>{const _0x214d7c=a0_0x1fb7;try{const {username:_0x369f1d,password:_0x2ae8b0,rolId:_0x168957,userId:_0x5b09aa}=_0x271d91['body'],_0x9bc6e0=await a0_0x39c844[_0x214d7c(0xc6)](_0x2ae8b0,0xa),_0xdfe865=await Account['create']({'username':_0x369f1d,'password':_0x9bc6e0,'rolId':_0x168957,'userId':_0x5b09aa});_0x186e6a[_0x214d7c(0xc8)]({'message':_0x214d7c(0xbf),'data':_0xdfe865});}catch(_0xd2715f){console[_0x214d7c(0xc3)]('error\x20al\x20crear\x20la\x20cuenta:',_0xd2715f);}};export const deleteAccount=async(_0x5686ca,_0x4f30ab)=>{const _0x170629=a0_0x1fb7;try{await Account['destroy']({'where':{'id':_0x5686ca[_0x170629(0xbd)]['id']}}),_0x4f30ab[_0x170629(0xc8)]({'message':_0x170629(0xc9)});}catch(_0x15e698){return _0x4f30ab[_0x170629(0xc2)](0x1f4)[_0x170629(0xc8)]({'message':_0x15e698[_0x170629(0xb9)]});}};export const updateAccount=async(_0x74a8b8,_0x2aaaf5)=>{const _0x1a23f4=a0_0x1fb7,_0x2f8878=_0x74a8b8[_0x1a23f4(0xd0)],_0x41560d=_0x74a8b8['params']['id'],_0x15242f={'username':_0x2f8878['username'],'rolId':_0x2f8878[_0x1a23f4(0xbc)]};try{if(_0x2f8878[_0x1a23f4(0xc7)]){const _0x33471a=await Account[_0x1a23f4(0xd4)]({'attributes':[_0x1a23f4(0xc7)],'where':{'id':_0x41560d}}),_0x275da2=await a0_0x39c844[_0x1a23f4(0xc5)](_0x2f8878[_0x1a23f4(0xc7)],_0x33471a[_0x1a23f4(0xc7)]);!_0x275da2&&_0x2aaaf5[_0x1a23f4(0xc2)](0x1f4)[_0x1a23f4(0xc8)]({'message':_0x1a23f4(0xd2)});const _0x326835=await a0_0x39c844[_0x1a23f4(0xc6)](_0x2f8878['password'],0xa);_0x15242f[_0x1a23f4(0xc7)]=_0x326835;}await Account[_0x1a23f4(0xda)](_0x15242f,{'where':{'id':_0x41560d}}),_0x2aaaf5[_0x1a23f4(0xc8)]({'message':_0x1a23f4(0xbb)});}catch(_0x278515){_0x2aaaf5[_0x1a23f4(0xc2)](0x1f4)['json']({'message':_0x278515['message']});}};export const updateAccountUser=async(_0x4c5302,_0x3efe9f)=>{const _0x3ae7a3=a0_0x1fb7,_0x1e7934=_0x4c5302[_0x3ae7a3(0xd0)],_0xc01e43=_0x4c5302['params']['id'],_0xb78360=_0x4c5302[_0x3ae7a3(0xbd)]['userId'];try{if(_0x1e7934[_0x3ae7a3(0xc7)]&&_0x1e7934[_0x3ae7a3(0xcb)]){const _0x242c35=await Account['findOne']({'attributes':[_0x3ae7a3(0xc7)],'where':{'id':_0xc01e43}}),_0x94b0c0=await a0_0x39c844[_0x3ae7a3(0xc5)](_0x1e7934[_0x3ae7a3(0xc7)],_0x242c35[_0x3ae7a3(0xc7)]);!_0x94b0c0&&_0x3efe9f[_0x3ae7a3(0xc2)](0x1f4)[_0x3ae7a3(0xc8)]({'message':_0x3ae7a3(0xd2)});const _0x61082d=await a0_0x39c844[_0x3ae7a3(0xc6)](_0x1e7934[_0x3ae7a3(0xcb)],0xa);await Account[_0x3ae7a3(0xda)]({'password':_0x61082d},{'where':{'id':_0xc01e43}});}await Users[_0x3ae7a3(0xda)](_0x1e7934,{'where':{'id':_0xb78360}});const _0xfcd9e=await Account[_0x3ae7a3(0xd4)]({'where':{'id':_0xc01e43},'include':[{'model':Roles,'as':_0x3ae7a3(0xd3)},{'model':Users,'as':_0x3ae7a3(0xd7)}]}),_0x553030={'ci':_0xfcd9e[_0x3ae7a3(0xd7)]['ci'],'firstName':_0xfcd9e[_0x3ae7a3(0xd7)][_0x3ae7a3(0xb6)],'secondName':_0xfcd9e['user'][_0x3ae7a3(0xb8)],'firstLastName':_0xfcd9e['user']['firstLastName'],'secondLastName':_0xfcd9e[_0x3ae7a3(0xd7)][_0x3ae7a3(0xd6)],'username':_0xfcd9e[_0x3ae7a3(0xd1)],'accountId':_0xfcd9e['id'],'userId':_0xfcd9e[_0x3ae7a3(0xd5)],'rolId':_0xfcd9e['rolId'],'loginRol':_0xfcd9e[_0x3ae7a3(0xd3)][_0x3ae7a3(0xcd)]};_0x3efe9f[_0x3ae7a3(0xc8)]({'message':_0x3ae7a3(0xbb),'data':_0x553030});}catch(_0xbda861){_0x3efe9f[_0x3ae7a3(0xc2)](0x1f4)[_0x3ae7a3(0xc8)]({'message':_0xbda861[_0x3ae7a3(0xb9)]});}};export const resetPassword=async(_0x14135,_0x364f90)=>{const _0x2bb18d=a0_0x1fb7,_0x17adbb=_0x14135[_0x2bb18d(0xbd)]['id'];try{const _0x170a75=await a0_0x39c844[_0x2bb18d(0xc6)](_0x2bb18d(0xb5),0xa);await Account[_0x2bb18d(0xda)]({'password':_0x170a75},{'where':{'id':_0x17adbb}}),_0x364f90[_0x2bb18d(0xc8)]({'message':_0x2bb18d(0xc1)});}catch(_0x68c061){_0x364f90[_0x2bb18d(0xc2)](0x1f4)[_0x2bb18d(0xc8)]({'message':_0x68c061[_0x2bb18d(0xb9)]});}};export const getRoles=async(_0x42c9bd,_0xb0ca46)=>{const _0xa3ff5d=a0_0x1fb7;try{const _0x25d237=await Roles[_0xa3ff5d(0xcf)]();_0xb0ca46[_0xa3ff5d(0xc8)](_0x25d237);}catch(_0x5c81e9){console['error']('Error\x20al\x20obtener\x20los\x20roles:',_0x5c81e9),_0xb0ca46['status'](0x1f4)[_0xa3ff5d(0xc8)]({'message':'Error\x20en\x20el\x20servidor.'});}};export const getOneRol=async(_0x4cf360,_0x1652c0)=>{const _0x2a5e0c=a0_0x1fb7,{id:_0x1fd80e}=_0x4cf360['params'];try{const _0x28a6d6=await Roles[_0x2a5e0c(0xd4)]({'where':{'id':_0x1fd80e}});_0x1652c0[_0x2a5e0c(0xc8)](_0x28a6d6);}catch(_0x33df82){_0x1652c0['status'](0x1f4)[_0x2a5e0c(0xc8)]({'message':_0x33df82[_0x2a5e0c(0xb9)]});}};export const addRol=async(_0x44361d,_0x5e4d15)=>{const _0x13bce1=a0_0x1fb7;try{const _0x36d7b1=_0x44361d[_0x13bce1(0xd0)],_0x51cd1d=await Roles[_0x13bce1(0xbe)](_0x36d7b1);_0x5e4d15[_0x13bce1(0xc8)]({'message':'agregado\x20con\x20éxito','data':_0x51cd1d});}catch(_0x43d692){console[_0x13bce1(0xc3)](_0x13bce1(0xba),_0x43d692);}};export const deleteRol=async(_0x31bc97,_0x262fb8)=>{const _0x40b60b=a0_0x1fb7;try{await Roles[_0x40b60b(0xc0)]({'where':{'id':_0x31bc97['params']['id']}}),_0x262fb8[_0x40b60b(0xc8)]({'message':'Rol\x20eleminado\x20con\x20éxito'});}catch(_0x5794c1){return _0x262fb8['status'](0x1f4)['json']({'message':_0x5794c1['message']});}};export const updateRol=async(_0x2c488e,_0x35881e)=>{const _0x52ffa7=a0_0x1fb7,_0x4a4b75=_0x2c488e['body'];try{await Roles[_0x52ffa7(0xda)](_0x4a4b75,{'where':{'id':_0x2c488e[_0x52ffa7(0xbd)]['id']}}),_0x35881e['json']({'message':'Rol\x20editado\x20con\x20éxito'});}catch(_0x3fb6a5){_0x35881e[_0x52ffa7(0xc2)](0x1f4)[_0x52ffa7(0xc8)]({'message':_0x3fb6a5[_0x52ffa7(0xb9)]});}};function a0_0xb7f1(){const _0x50ca92=['compare','hash','password','json','Cuenta\x20eleminado\x20con\x20éxito','18445923xpDuTG','confirmPassword','301SEjxQl','name','Error\x20en\x20el\x20servidor.','findAll','body','username','La\x20contraseña\x20no\x20coincide\x20con\x20la\x20Anterior','role','findOne','userId','secondLastName','user','2929878egbCeM','2976525epdMdV','update','2qmshXS','616211oPNfuo','Error\x20al\x20obtener\x20usuarios:','73536meOwgb','12345678','firstName','4013800nmJsXQ','secondName','message','error\x20al\x20crear\x20el\x20rol:','cuenta\x20editado\x20con\x20éxito','rolId','params','create','agregado\x20con\x20éxito','destroy','Password\x20Reseteda\x20a\x2012345678\x20con\x20éxito','status','error','1160288tiOnjw'];a0_0xb7f1=function(){return _0x50ca92;};return a0_0xb7f1();}