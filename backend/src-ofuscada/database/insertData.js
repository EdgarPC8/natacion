const a5_0x51c6f0=a5_0x43b9;(function(_0x5a55eb,_0x57fe46){const _0x1773fd=a5_0x43b9,_0x28c3e1=_0x5a55eb();while(!![]){try{const _0x5910b5=parseInt(_0x1773fd(0x1b1))/0x1+parseInt(_0x1773fd(0x1cf))/0x2*(-parseInt(_0x1773fd(0x1ce))/0x3)+-parseInt(_0x1773fd(0x1cd))/0x4+-parseInt(_0x1773fd(0x1d3))/0x5+parseInt(_0x1773fd(0x1ae))/0x6+-parseInt(_0x1773fd(0x1d1))/0x7+-parseInt(_0x1773fd(0x1c3))/0x8*(-parseInt(_0x1773fd(0x1b2))/0x9);if(_0x5910b5===_0x57fe46)break;else _0x28c3e1['push'](_0x28c3e1['shift']());}catch(_0x5a3f44){_0x28c3e1['push'](_0x28c3e1['shift']());}}}(a5_0x2954,0xb9d1d));import{promises as a5_0x54ca40}from'fs';import{resolve}from'path';import{Roles}from'../models/Roles.js';import{Users}from'../models/Users.js';import{Account}from'../models/Account.js';function a5_0x43b9(_0x9c4281,_0x5a0b7a){const _0x29545d=a5_0x2954();return a5_0x43b9=function(_0x43b93d,_0x50f3e7){_0x43b93d=_0x43b93d-0x1ab;let _0x377bc7=_0x29545d[_0x43b93d];return _0x377bc7;},a5_0x43b9(_0x9c4281,_0x5a0b7a);}import{sequelize}from'./connection.js';const backupFilePath=resolve('./src/database/backup.json'),backups=resolve(a5_0x51c6f0(0x1c2));async function clearTables(){const _0x4f8e1d=a5_0x51c6f0,_0x329216=await sequelize[_0x4f8e1d(0x1d4)]();try{await Users[_0x4f8e1d(0x1c6)]({'transaction':_0x329216}),await Roles[_0x4f8e1d(0x1c6)]({'transaction':_0x329216}),await Account[_0x4f8e1d(0x1c6)]({'transaction':_0x329216}),await _0x329216[_0x4f8e1d(0x1c1)](),console[_0x4f8e1d(0x1ab)]('Todas\x20las\x20tablas\x20han\x20sido\x20limpiadas\x20exitosamente.');}catch(_0x582f99){await _0x329216['rollback'](),console['error'](_0x4f8e1d(0x1d5),_0x582f99);}}export const insertData=async()=>{const _0x5d3034=a5_0x51c6f0;try{await a5_0x54ca40[_0x5d3034(0x1bd)](backupFilePath),console[_0x5d3034(0x1ab)](_0x5d3034(0x1be));const _0x6b633b=await a5_0x54ca40[_0x5d3034(0x1ac)](backupFilePath,'utf8'),_0x4d7613=JSON[_0x5d3034(0x1d0)](_0x6b633b);await Roles[_0x5d3034(0x1b9)](_0x4d7613[_0x5d3034(0x1c7)],{'returning':!![]}),await Users['bulkCreate'](_0x4d7613[_0x5d3034(0x1d2)],{'returning':!![]}),await Account[_0x5d3034(0x1b9)](_0x4d7613[_0x5d3034(0x1b8)],{'returning':!![]}),console[_0x5d3034(0x1ab)](_0x5d3034(0x1ad));}catch(_0x44bf48){_0x44bf48[_0x5d3034(0x1c4)]===_0x5d3034(0x1b4)?(await a5_0x54ca40[_0x5d3034(0x1b3)](backupFilePath,JSON[_0x5d3034(0x1b5)]({'Roles':[],'Users':[],'Account':[]},null,0x2)),console[_0x5d3034(0x1ab)](_0x5d3034(0x1ca))):console['error']('Error\x20al\x20insertar\x20datos:',_0x44bf48);}};let saveBackupCallCount=0x0;function a5_0x2954(){const _0x3a010e=['transaction','Error\x20al\x20limpiar\x20las\x20tablas:','log','readFile','Datos\x20insertados\x20correctamente\x20desde\x20el\x20archivo\x20de\x20respaldo.','6045966CeIDMC','json','Archivo\x20de\x20respaldo\x20principal\x20actualizado:','329654wcBurD','16452HXkrqC','writeFile','ENOENT','stringify','.json','slice','Account','bulkCreate','backup-','error','replace','access','El\x20archivo\x20de\x20respaldo\x20ya\x20existe.','Backup\x20guardado\x20correctamente\x20en:','send','commit','./src/backups','6472OycnYx','code','status','truncate','Roles','mkdir','toISOString','Archivo\x20de\x20respaldo\x20creado:\x20backup.json','findAll','Error\x20al\x20realizar\x20el\x20backup:','2026392ffdyAI','1343091eraNah','2akwaNH','parse','4923219TKIqmJ','Users','1987190bbHepV'];a5_0x2954=function(){return _0x3a010e;};return a5_0x2954();}export const saveBackup=async()=>{const _0x620623=a5_0x51c6f0;try{const _0x388842=await Roles[_0x620623(0x1cb)](),_0x238906=await Users[_0x620623(0x1cb)](),_0x449577=await Account['findAll'](),_0x1538e4={'Roles':_0x388842,'Users':_0x238906,'Account':_0x449577};await a5_0x54ca40[_0x620623(0x1c8)](backups,{'recursive':!![]});const _0x574c91=new Date(),_0x368a85=_0x574c91[_0x620623(0x1c9)]()[_0x620623(0x1bc)](/[:.]/g,'-')[_0x620623(0x1b7)](0x0,0x13),_0x3ed4f4=_0x620623(0x1ba)+_0x368a85+_0x620623(0x1b6),_0x110653=resolve(backups,_0x3ed4f4);return await a5_0x54ca40[_0x620623(0x1b3)](_0x110653,JSON[_0x620623(0x1b5)](_0x1538e4,null,0x2)),console[_0x620623(0x1ab)](_0x620623(0x1bf),_0x110653),await a5_0x54ca40[_0x620623(0x1b3)](backupFilePath,JSON['stringify'](_0x1538e4,null,0x2)),console[_0x620623(0x1ab)](_0x620623(0x1b0),backupFilePath),_0x110653;}catch(_0x40a3bd){console['error']('Error\x20al\x20guardar\x20el\x20backup:',_0x40a3bd);throw _0x40a3bd;}};export const downloadBackup=async(_0x1cb5fa,_0x445a42)=>{const _0x47ac1a=a5_0x51c6f0;try{const _0x5d7280=await saveBackup();_0x445a42[_0x47ac1a(0x1c5)](0xc8)[_0x47ac1a(0x1af)](_0x5d7280);}catch(_0x4a10ce){console[_0x47ac1a(0x1bb)](_0x47ac1a(0x1cc),_0x4a10ce),_0x445a42[_0x47ac1a(0x1c5)](0x1f4)[_0x47ac1a(0x1c0)]('Error\x20al\x20realizar\x20el\x20backup.');}};